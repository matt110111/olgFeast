{% extends "shop_front/base.html" %}

{% block content %}
{% csrf_token %}
<style>
.card {

  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
  width: 100%;
  margin-top: 10px;
}

.card:hover {
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
}

.container_ {
  
  padding: 20px 25px;
}
.container__ {
	  align-content: center;
	  padding: 20px 50px;
	}
}

button{
    position: fixed;
    bottom: 20px;
    

}
button:last-child{
    left:40px

}

.admin-controls {
	margin-top: 10px;
}

.admin-controls .btn {
	margin-right: 5px;
	margin-bottom: 5px;
}

</style>
<a>{{ group }}</a>
<div class="row">
{% for food in items %}
	<div class="col-md-4">
	   <a href="{% url 'shopping_cart:add_to_cart' food.id %}">
	   <div class="card">
	      <div class="container_">
	      	<h6><b>{{ food.name }}</b></h6> 
	      	{% if user.is_superuser %}
	      	<h6><b>Price: ${{ food.value }}</b></h6>
	      	{% endif %}
	      	<h6><b>Tickets: {{ food.ticket }}</b></h6>
	      </div>
	  </div>
	  </a>
	  
	  {% if user.is_superuser %}
	  <div class="admin-controls mt-2">
	  	<a href="{% url 'shop_front:item-update' food.id %}" class="btn btn-sm btn-warning">
	  		<i class="fas fa-edit"></i> Edit
	  	</a>
	  	<button class="btn btn-sm btn-danger" onclick="deleteItem({{ food.id }}, '{{ food.name }}')">
	  		<i class="fas fa-trash"></i> Delete
	  	</button>
	  </div>
	  {% endif %}

	      <!-- if last column in row -->
</div>
{% endfor %}
<div class="container__ fixed-bottom">
		<button class="btn btn-primary" onclick="location.href='{% url 'shop_front:shop_front-home' %}'">Back</button>
		<button class="btn btn-primary" onclick="location.href='{% url 'shopping_cart:order_summary' %}'">Order_Summary</button>
		
		{% if user.is_superuser %}
		<a href="{% url 'shop_front:item-create' %}" class="btn btn-success">
			<i class="fas fa-plus"></i> Add New Item
		</a>
		{% endif %}
	</div>

<script>
function deleteItem(itemId, itemName) {
	if (confirm(`Are you sure you want to delete "${itemName}"? This action cannot be undone.`)) {
		// Create a form to submit the delete request
		const form = document.createElement('form');
		form.method = 'POST';
		form.action = `/shop/item/${itemId}/delete/`;
		
		// Add CSRF token
		const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
		const csrfInput = document.createElement('input');
		csrfInput.type = 'hidden';
		csrfInput.name = 'csrfmiddlewaretoken';
		csrfInput.value = csrfToken;
		form.appendChild(csrfInput);
		
		document.body.appendChild(form);
		form.submit();
	}
}
</script>

{% endblock content %}